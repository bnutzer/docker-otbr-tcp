#!/command/with-contenv bash

set -eu

for i in $(seq 1 180); do
	if wrap-ot-ctl state >/dev/null 2>&1; then
		# Valid response. Give service a few additional seconds.
		echo "otbr-agent is ready."
		sleep 3
		exit 0
	fi
	sleep 1
done
echo "otbr-agent-ready: ot-ctl never responded, startup failed." >&2
exit 1
